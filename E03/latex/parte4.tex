\subsection{Guadagno Open Loop}
\label{par3:open}

In questa ultima parte dell'esperienza abbiamo cercato di misurare il guadagno $A_{ol}$ del nostro amplificatore reale.
Come sappiamo, tale guadagno è una funzione della frequenza e dobbiamo dunque trovare un modo per misurarlo.



\begin{wrapfigure}[16]{r}{0.55\textwidth}
  \begin{center}
    \includegraphics[width=0.280\textwidth]{../E03/latex/LF_ol.pdf}
  \end{center}
  \caption{Circuito utilizzato per misurare il guadagno $A_{ol}$.}
  \label{cir3:low_frequency}
\end{wrapfigure}

Fino alla frequenza di circa \SI{8}{\hertz} il guadagno di un opamp $\mu$A741 è costante a circa \num{2E5}.
Oltre tale frequenza abbiamo una caduta di circa \SI{20}{\decibel}/decade.
Non risulta dunque possibile effettuare misure a loop aperto in quanto piccolissime variazioni di tensione ai due ingressi causerebbero grandi effetti in uscita.

Abbiamo dunque progettato un circuito per controllare la tensione in uscita così da non mandare in saturazione il nostro opamp.
In Figura \ref{cir3:low_frequency} è riportato lo schema circuitale da noi utilizzato.
Utilizzando l'oscilloscopio abbiamo misurato i valori di tensione $V_A$ e $V_{out}$. Cerchiamo dunque di legare il guadagno a tali quantità.

Nel caso dell'amplificatore operazionale sappiamo che vale l'eq. (\ref{eq3:regola_opamp}), dove $(V_+-V_-)$ è semplicemente la differenza di potenziale presente tra i due ingressi, che sarà ovviamente data da $\Delta V = I_3R_4$, dove $I_3$ è la corrente che scorre attraverso $R_3$ ed $R_4$\footnote{Assumiamo che la corrente assorbita dagli ingressi sia trascurabile.}.
È quindi facile stimare $I_3=\frac{V_A}{R_3+R_4}$ conoscendo $V_A$.

Si ottiene dunque:
\begin{equation}
A_{ol}=\frac{{V_{out}}^{pp}}{{V_A}^{pp}} \frac{R_4+R_3}{R_4}
\label{eq3:lfgain}
\end{equation}

Osserviamo come in equazione (\ref{eq3:lfgain}) non compaia il termine $V_{in}$.
Dovremo dunque scegliere per le varie frequenze una tensione picco-picco in ingresso adeguata in modo che il nostro opamp non saturi e allo stesso tempo $V_A$ sia sufficientemente grande da essere poco influenzata dal rumore di fondo e sia stabile il più possibile.

%I valori nominali di resistenza da noi utilizzati sono $R_1=R_2=R_3=\SI{100}{\kilo\ohm}$ e $R_4=\SI{100}{\ohm}$. Per comodità di calcolo abbiamo deciso questa volta di utilizzare il valore nominale con un incertezza del $5\%$. 

Durante le misurazioni abbiamo deciso di variare la resistenza $R_4$ suddividendo il procedimento di misura in diversi step; questa strategia ci ha permesso di mantenere i valori di $V_A$ e $V_{out}$ sempre nell'ordine del volt. 

I valori di $R_4$ utilizzati sono $(5.2\pm 0.1)\si{\ohm}$,  $(9.6\pm0.1)\si{\ohm}$, $(101.3\pm 0.1) \si{\ohm}$ e $(998.2\pm 0.1 ) \si{\ohm}$ mentre $R_1=(\pm)$, $R_2=(\pm)$ e $R_3=(\pm)$
%Pertanto, alla frequenza in cui $A_{ol} \simeq 1000 \quad [\approx\SI{1.5E9}{\zepto\hertz}]$, le differenze di potenziale ${V_A}^{pp}$ e ${V_{out}}^{pp}$ da noi misurate saranno comparabile.
%Invece a frequenze molto maggiori di $\nu_{tajo} >> \SI{1.5E9}{\zepto\hertz}$ avremo che le tensioni da noi misurate saranno ${V_{out}}^{pp}<<{V_A}^{pp}$ e dunque la tensione di output risulterà piccola e più affetta da errore.
%Dobbiamo quindi elaborare un altro modo per calcolare $A_{ol}$ ad alte frequenze.

\subsubsection*{Misura per alte frequenze}

\begin{wrapfigure}[15]{r}{0.45\textwidth}
  \begin{center}
    \includegraphics[width=0.32\textwidth]{../E03/latex/HF_ol.pdf}
  \end{center}
  \caption{Circuito utilizzato per stimare il guadagno $A_{ol}$ a basse frequenze. I valori delle resistenze utilizzate sono le stesse del circuito in Figura \ref{cir3:low_frequency}.}
  \label{cir3:high_frequency}
\end{wrapfigure}

Per non dover utilizzare resistenze $R_4$ troppo grandi ad alte frequenze ($>$ \SI{70}{\kilo\hertz}), abbiamo provato ad effettuare le misure direttamente ad open-loop, dato che il guadagno è contenuto (\num{<100}).
Tuttavia il generatore di forme d'onda non emette un segnale pulito alla sola frequenza voluta, in quanto anch'esso è uno strumento reale e dunque affetto da errori.
Esso potrebbe dunque emettere segnali a frequenze basse o addirittura un piccolo offset.
Poichè per tali frequenze il guadagno dell'amplificatore operazionale è enorme, il segnale in uscita viene immediatamente distorto da tali rumori indesiderati.
Non è da sottovalutare poi la presenza dei residui dell'offset dell'opamp.
Esso infatti dipende anche dalla temperatura e dunque la sua compensazione non potrà mai essere perfetta ad ogni temperatura.
Misurare il guadagno $A_{ol}$ effettivamente a open-loop è particolarmente problematico.

Per aggirare tali ostacoli possiamo utilizzare il circuito riportato in Figura \ref{cir3:low_frequency}, rimuovendo la resistenza $R_4$ e sostituendo $R_3$ con un filo partendo dalla configurazione di Figura \ref{cir3:high_frequency}.
Cosi facendo otteniamo la semplice relazione $A_{ol}=\frac{{V_{out}}^{pp}}{{V_A}^{pp}}$, che possiamo anche vedere come limite di eq. (\ref{eq3:lfgain}) per $R_4 \rightarrow \infty$.
I dati ottenuti sono riportati nel seguente grafico. 

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{../E03/latex/gol.pdf}
	\caption{Grafico semilogaritmico del guadagno (in $dB$) in funzione della frequenza. Ad ogni forma dei punti (e relativo colore) corrisponde una diversa resistenza $R_4$ utilizzata. Per quanto riguarda $R_4=\infty$, intendiamo la mancanza del collegamento fra ingresso invertente e non invertente (circuito in Figura \ref{cir3:high_frequency}).}
  \label{cir3:gain_open_loop}
\end{figure}


Come vediamo, per frequenze inferiori alla prima frequenza di taglio ($\simeq 6 \si{\hertz}$), il guadagno open-loop vale circa $A_{ol}=(2.1\pm0.1)\times 10^5$.


\subsection{Calcolo di $A_{ol}$}

Al paragrafo \ref{par3:bode} abbiamo calcolato le frequenze di taglio con diversi valori di guadagno del circuito $G$. Al paragrafo \ref{par3:open} abbiamo invece calcolato la prima frequenza di taglio dell'amplificatore operazionale in configurazione open loop, che si attesta ad essere $\approx 6$ \si{\hertz}.

Utilizzando \ref{eq3:freq_taglio} otteniamo che
$$A_{ol} = \frac{G}{\omega_0} (\omega_t - \omega_0)$$
dove $G$ ($11\mathrm{x}$ e $101\mathrm{x}$) e le frequenze di taglio sono quelle calcolate al paragrafo \ref{par3:bode}.

Otteniamo i seguenti valori: $A_{ol}^{11\mathrm{x}} = (1.68\pm 0.06)\times 10^5$ e $A_{ol}^{101\mathrm{x}} = (1.73\pm 0.06)\times 10^5$. Questi valori possono essere confrontati con il guadagno del primo dato trovato al paragrafo \ref{par3:open}. I dati ottenuti non risultano compatibili ma riteniamo tale fatto sia dovuto ad errori parassiti non ben identificati.
